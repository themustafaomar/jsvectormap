!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).JsVectorMap=e()}(this,(function(){"use strict";Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(t){for(var e=(this.document||this.ownerDocument).querySelectorAll(t),s=e.length;--s>=0&&e.item(s)!==this;);return s>-1}),Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(t){if(null==t)throw new TypeError("Cannot convert first argument to object");for(var e=Object(t),s=1;s<arguments.length;s++){var i=arguments[s];if(null!=i){i=Object(i);for(var a=Object.keys(Object(i)),r=0,n=a.length;r<n;r++){var o=a[r],h=Object.getOwnPropertyDescriptor(i,o);void 0!==h&&h.enumerable&&(e[o]=i[o])}}}return e}});var t=function(){function t(t){return t instanceof Element?(this.selector=t,this):(this.selector=document.querySelector(t),this)}var e=t.prototype;return e.on=function(t,e){return this.selector.addEventListener(t,e),this},e.delegate=function(t,e,s){for(var i in e=e.split(" "))this.on(e[i],(function(e){var i=e.target;i.matches(t)&&s.call(i,e)}))},e.css=function(t){for(var e in t)this.selector.style[e]=t[e];return this},e.text=function(t){return t?(this.selector.textContent=t,this):this.selector.textContent},e.attr=function(t,e){return t&&e?(this.selector.setAttribute(t,e),this):this.selector.getAttribute(t)},e.append=function(t){return this.selector.appendChild(t),this},e.show=function(){this.css({display:"block"})},e.hide=function(){this.css({display:"none"})},e.height=function(){return this.selector.offsetHeight},e.width=function(){return this.selector.offsetWidth},t}(),e=function(t){return function(t){return!!t&&"object"==typeof t}(t)&&!function(t){var e=Object.prototype.toString.call(t);return"[object RegExp]"===e||"[object Date]"===e||function(t){return t.$$typeof===s}(t)}(t)};var s="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function i(t,e){return!1!==e.clone&&e.isMergeableObject(t)?h((s=t,Array.isArray(s)?[]:{}),t,e):t;var s}function a(t,e,s){return t.concat(e).map((function(t){return i(t,s)}))}function r(t){return Object.keys(t).concat(function(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter((function(e){return t.propertyIsEnumerable(e)})):[]}(t))}function n(t,e){try{return e in t}catch(t){return!1}}function o(t,e,s){var a={};return s.isMergeableObject(t)&&r(t).forEach((function(e){a[e]=i(t[e],s)})),r(e).forEach((function(r){(function(t,e){return n(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))})(t,r)||(n(t,r)&&s.isMergeableObject(e[r])?a[r]=function(t,e){if(!e.customMerge)return h;var s=e.customMerge(t);return"function"==typeof s?s:h}(r,s)(t[r],e[r],s):a[r]=i(e[r],s))})),a}var h=function(t,s,r){(r=r||{}).arrayMerge=r.arrayMerge||a,r.isMergeableObject=r.isMergeableObject||e,r.cloneUnlessOtherwiseSpecified=i;var n=Array.isArray(s);return n===Array.isArray(t)?n?r.arrayMerge(t,s,r):o(t,s,r):i(s,r)},l=function(t){return/\.(jpg|gif|png)$/.test(t)},c=function(t,e,s,i){void 0===i&&(i=!1);var a=document.createElement(t);return s&&(a[i?"innerHTML":"textContent"]=s),e&&(a.className=e),a},p=function(e){return new t(e)},u=function(t){return t.replace(/[\w]([A-Z])/g,(function(t){return t[0]+"-"+t[1]})).toLowerCase()},d=function(t){return"function"==typeof t},f=function(t){return"object"==typeof t},m=function(t){return"string"==typeof t},g=function(t){return Array.isArray(t)},v=function(t,e){return h(t,e)};function y(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}function b(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var S=function(){function t(t,e){this.name=t,this.properties={},this.node=this.createElement(t),e&&this.set(e)}var e=t.prototype;return e.createElement=function(t){return document.createElementNS("http://www.w3.org/2000/svg",t)},e.addClass=function(t){this.node.setAttribute("class",t)},e.getElementCtr=function(t){return SVG+t},e.getBBox=function(){return this.node.getBBox()},e.set=function(t,e){if(f(t))for(var s in t)this.properties[s]=t[s],this.applyAttr(s,t[s]);else this.properties[t]=e,this.applyAttr(t,e)},e.get=function(t){return this.properties[t]},e.applyAttr=function(t,e){this.node.setAttribute(u(t),e)},e.remove=function(){this.node.parentNode.removeChild(this.node)},t}(),w=function(t){function e(e,s,i){var a;return(a=t.call(this,e,s)||this).style=i||{},a.style.current=a.style.current||{},a.isHovered=!1,a.isSelected=!1,a.updateStyle(),a}y(e,t);var s=e.prototype;return s.setStyle=function(t,e){var s={};f(t)?s=t:s[t]=e,Object.assign(this.style.current,s),this.updateStyle()},s.updateStyle=function(){var t={};this.mergeStyles(t,this.style.initial),this.mergeStyles(t,this.style.current),this.isHovered&&this.mergeStyles(t,this.style.hover),this.isSelected&&(this.mergeStyles(t,this.style.selected),this.isHovered&&this.mergeStyles(t,this.style.selectedHover)),this.set(t)},s.mergeStyles=function(t,e){for(var s in e=e||{})null===e[s]?delete t[s]:t[s]=e[s]},e}(S),M=function(t){function e(e,s){return t.call(this,"text",e,s)||this}return y(e,t),e.prototype.applyAttr=function(e,s){"text"===e?this.node.textContent=s:t.prototype.applyAttr.call(this,e,s)},e}(w),k=function(t){function e(e,s){return t.call(this,"image",e,s)||this}y(e,t);var s=e.prototype;return s.applyAttr=function(e,s){var i;"image"==e?(f(s)?(i=s.url,this.offset=s.offset):(i=s,this.offset=[0,0]),this.node.setAttributeNS("http://www.w3.org/1999/xlink","href",i),this.width=23,this.height=23,this.applyAttr("width",this.width),this.applyAttr("height",this.height),this.applyAttr("x",this.cx-this.width/2+this.offset[0]),this.applyAttr("y",this.cy-this.height/2+this.offset[1])):"cx"==e?(this.cx=s,this.width&&this.applyAttr("x",s-this.width/2+this.offset[0])):"cy"==e?(this.cy=s,this.height&&this.applyAttr("y",s-this.height/2+this.offset[1])):t.prototype.applyAttr.apply(this,arguments)},s.setStyle=function(){t.prototype.setStyle.apply(this,arguments)},e}(w),x=function(t){function e(e,s,i){var a;return(a=t.call(this,"svg")||this).container=e,a.defsElement=new S("defs"),a.node.appendChild(a.defsElement.node),a.rootElement=new S("g"),a.node.appendChild(a.rootElement.node),a.container.append(a.node),a}y(e,t);var s=e.prototype;return s.setSize=function(t,e){this.node.setAttribute("width",t),this.node.setAttribute("height",e)},s.applyTransformParams=function(t,e,s){this.rootElement.node.setAttribute("transform","scale("+t+") translate("+e+", "+s+")")},s.createPath=function(t,e,s){var i=new w("path",t,e);return i.node.setAttribute("fill-rule","evenodd"),this.add(i,s),i},s.createCircle=function(t,e,s){var i=new w("circle",t,e);return this.add(i,s),i},s.createImage=function(t,e,s){var i=new k(t,e);return this.add(i,s),i},s.createText=function(t,e,s){var i=new M(t,e);return this.add(i,s),i},s.createGroup=function(t){var e=new S("g");return t?t.node.appendChild(e.node):this.node.appendChild(e.node),e.canvas=this,e},s.add=function(t,e){(e=e||this.rootElement).node.appendChild(t.node),t.canvas=this},e}(S);var j=function(){function t(){}var e=t.prototype;return e.getLabelText=function(t){var e=this.config.label;if(e)return d(e.render)?e.render(t):t},e.getLabelOffsets=function(t){var e=this.config.label;if(e){if(d(e.offsets))return e.offsets(t);if(f(e.offsets))return this.config.label.offsets[t]}return[0,0]},e.setStyle=function(t,e){this.shape.setStyle(t,e)},e.remove=function(){this.shape.remove(),this.label&&this.label.remove()},e.hoverStatus=function(t){this.shape.isHovered=t,this.shape.updateStyle(),this.isHovered=t,this.label&&(this.label.isHovered=t,this.label.updateStyle())},e.select=function(){this._selectStatus(!0)},e.deselect=function(){this._selectStatus(!1)},e._selectStatus=function(t){this.shape.isSelected=t,this.shape.updateStyle(),this.isSelected=t,this.label&&(this.label.isSelected=t,this.label.updateStyle())},t}(),Y=function(t){function e(e){var s,i=e.map,a=e.code,r=e.path,n=e.style,o=e.label,h=e.labelStyle,l=e.labelsGroup;(s=t.call(this)||this).config=arguments[0],s.canvas=i.canvas,s.map=i,s.shape=s.canvas.createPath({"data-code":a,d:r},n,s.canvas.rootElement),s.shape.addClass("jsvmap-region jsvmap-element");var c=s.shape.getBBox(),p=s.getLabelText(a);if(o&&p){var u=s.getLabelOffsets(a);s.labelX=c.x+c.width/2+u[0],s.labelY=c.y+c.height/2+u[1],s.label=s.canvas.createText({text:p,"text-anchor":"middle","alignment-baseline":"central","data-code":a,x:s.labelX,y:s.labelY},h,l),s.label.addClass("jsvmap-region jsvmap-element")}return s}return y(e,t),e.prototype.updateLabelPosition=function(){this.label&&this.label.set({x:this.labelX*this.map.scale+this.map.transX*this.map.scale,y:this.labelY*this.map.scale+this.map.transY*this.map.scale})},e}(j);var C=function(t){function e(e){var s,i,a=e.index,r=e.style,n=e.label,o=e.labelsGroup,h=e.cx,l=e.cy,c=e.map,p=e.isRecentlyCreated;return(s=t.call(this)||this).map=c,s.config=arguments[0],s.isImage=!!r.initial.image,s.createShape(),i=p&&n.render&&p.label?p.label:t.prototype.getLabelText.call(b(s),a),n&&i&&(s.offsets=p&&n.render&&p.offset?p.offset:t.prototype.getLabelOffsets.call(b(s),a),s.labelX=h/c.scale-c.transX,s.labelY=l/c.scale-c.transY,s.label=c.canvas.createText({text:i,"data-index":a,dy:"0.6ex",x:s.labelX,y:s.labelY},c.params.markerLabelStyle,o),s.label.addClass("jsvmap-marker jsvmap-element"),p&&s.updateLabelPosition()),s}y(e,t);var s=e.prototype;return s.createShape=function(){this.shape&&this.shape.remove(),this.shape=this.config.map.canvas[this.isImage?"createImage":"createCircle"]({"data-index":this.config.index,cx:this.config.cx,cy:this.config.cy},this.config.style,this.config.group),this.shape.addClass("jsvmap-marker jsvmap-element"),this.isImage&&this.updateLabelPosition()},s.updateLabelPosition=function(){this.label&&this.label.set({x:this.labelX*this.map.scale+this.offsets[0]+this.map.transX*this.map.scale+5+(this.isImage?(this.shape.width||0)/2:this.shape.properties.r),y:this.labelY*this.map.scale+this.map.transY*this.map.scale+this.offsets[1]})},s.setStyle=function(e,s){t.prototype.setStyle.call(this,e,s),"r"===e&&this.updateLabelPosition(),!!this.shape.get("image")!=this.isImage&&(this.config.style=Object.assign({},this.shape.style),this.createShape())},e}(j);var X=function(){function t(t){this.params=t||{},this.map=this.params.map,this.series=this.params.series,this.body=c("div","jsvmap-legend"),this.params.cssClass&&this.body.setAttribute("class",this.params.cssClass),t.vertical?this.map.legendVertical.appendChild(this.body):this.map.legendHorizontal.appendChild(this.body),this.render()}return t.prototype.render=function(){var t,e,s,i=this.series.scale.getTicks(),a=c("div","jsvmap-legend-inner");if(this.body.innderHTML="",this.params.title){var r=c("div","jsvmap-legend-title",this.params.title);this.body.appendChild(r)}this.body.appendChild(a);for(var n=0;n<i.length;n++){switch(t=c("div","jsvmap-legend-tick"),e=c("div","jsvmap-legend-tick-sample"),this.series.legendConfig.attribute){case"fill":l(i[n].value)?e.style.background="url("+i[n].value+")":e.style.background=i[n].value;break;case"stroke":e.style.background=i[n].value;break;case"image":e.style.background="url("+(f(i[n].value)?i[n].value.url:i[n].value)+") no-repeat center center",e.style.backgroundSize="cover"}t.appendChild(e),s=i[n].label,this.params.labelRender&&(s=this.params.labelRender(s));var o=c("div","jsvmap-legend-tick-text",s);t.appendChild(o),a.appendChild(t)}},t}(),O=function(){function t(t){this.scale=t}var e=t.prototype;return e.getValue=function(t){return this.scale[t]},e.getTicks=function(){var t=[];for(var e in this.scale)t.push({label:e,value:this.scale[e]});return t},t}(),E=function(){function t(t,e,s){void 0===t&&(t={}),this.map=s,this.elements=e,this.legendConfig=t,this.legendConfig.attribute=t.attribute||"fill",this.values=t.values||{},t.attributes&&this.setAttributes(t.attributes),f(t.scale)&&(this.scale=new O(t.scale)),this.parseValues(this.values),this.legendConfig.legend&&(this.legend=new X(Object.assign({map:this.map,series:this},this.legendConfig.legend)))}var e=t.prototype;return e.parseValues=function(t){var e={};for(var s in t)t[s]&&(e[s]=this.scale.getValue(t[s]));this.setAttributes(e),Object.assign(this.values,t)},e.setAttributes=function(t){for(var e in t)this.elements[e]&&this.elements[e].element.setStyle(this.legendConfig.attribute,t[e])},e.clear=function(){var t,e={};for(t in this.values)this.elements[t]&&(e[t]=this.elements[t].element.shape.style.initial[this.legendConfig.attribute]);this.setAttributes(e),this.values={}},t}();function T(t,e,s){var i=p(e),a=-1===i.attr("class").indexOf("jsvmap-region")?"marker":"region",r="region"===a?i.attr("data-code"):i.attr("data-index"),n=a+":select";return s&&(n=a+".tooltip:show"),{event:n,type:a,code:r,element:"region"===a?t.regions[r].element:t.markers[r].element,tooltipText:"region"===a?t.mapData.paths[r].name||"":t.markers[r].config.name||""}}var A={mill:function(t,e,s){return{x:this.radius*(e-s)*this.radDeg,y:-this.radius*Math.log(Math.tan((45+.4*t)*this.radDeg))/.8}},merc:function(t,e,s){return{x:this.radius*(e-s)*this.radDeg,y:-this.radius*Math.log(Math.tan(Math.PI/4+t*Math.PI/360))}},aea:function(t,e,s){var i=s*this.radDeg,a=29.5*this.radDeg,r=45.5*this.radDeg,n=t*this.radDeg,o=e*this.radDeg,h=(Math.sin(a)+Math.sin(r))/2,l=Math.cos(a)*Math.cos(a)+2*h*Math.sin(a),c=h*(o-i),p=Math.sqrt(l-2*h*Math.sin(n))/h,u=Math.sqrt(l-2*h*Math.sin(0))/h;return{x:p*Math.sin(c)*this.radius,y:-(u-p*Math.cos(c))*this.radius}},lcc:function(t,e,s){var i=s*this.radDeg,a=e*this.radDeg,r=33*this.radDeg,n=45*this.radDeg,o=t*this.radDeg,h=Math.log(Math.cos(r)*(1/Math.cos(n)))/Math.log(Math.tan(Math.PI/4+n/2)*(1/Math.tan(Math.PI/4+r/2))),l=Math.cos(r)*Math.pow(Math.tan(Math.PI/4+r/2),h)/h,c=l*Math.pow(1/Math.tan(Math.PI/4+o/2),h),p=l*Math.pow(1/Math.tan(Math.PI/4+0),h);return{x:c*Math.sin(h*(a-i))*this.radius,y:-(p-c*Math.cos(h*(a-i)))*this.radius}}};A.degRad=180/Math.PI,A.radDeg=Math.PI/180,A.radius=6381372;var z=Object.freeze({__proto__:null,handleContainerEvents:function(){var t,e,s=this,i=!1,a=this;this.params.draggable&&(this.container.on("mousemove",(function(s){return i&&(a.transX-=(t-s.pageX)/a.scale,a.transY-=(e-s.pageY)/a.scale,a.applyTransform(),t=s.pageX,e=s.pageY),!1})).on("mousedown",(function(s){return i=!0,t=s.pageX,e=s.pageY,!1})),p("body").on("mouseup",(function(){i=!1}))),this.params.zoomOnScroll&&this.container.on("wheel",(function(t){var e=0;t.preventDefault(),e=(t.deltaY||-t.wheelDelta||t.detail)>>10||1,e*=75;var i=s.container.selector.getBoundingClientRect(),r=t.pageX-i.left-window.pageXOffset,n=t.pageY-i.top-window.pageYOffset,o=Math.pow(1+a.params.zoomOnScrollSpeed/1e3,-1.5*e);a.tooltip.hide(),a.setScale(a.scale*o,r,n),t.preventDefault()}))},handleZoomButtons:function(){var t=this,e=this,s=c("div","jsvmap-zoomin","&#43;",!0),i=c("div","jsvmap-zoomout","&#x2212",!0);this.container.append(s).append(i),s.addEventListener("click",(function(){t.setScale(e.scale*e.params.zoomStep,e.width/2,e.height/2,!1,e.params.zoomAnimate)})),i.addEventListener("click",(function(){t.setScale(e.scale/e.params.zoomStep,e.width/2,e.height/2,!1,e.params.zoomAnimate)}))},createRegions:function(){var t,e;for(t in this.regionLabelsGroup=this.regionLabelsGroup||this.canvas.createGroup(),this.mapData.paths)e=new Y({map:this,code:t,path:this.mapData.paths[t].path,style:Object.assign({},this.params.regionStyle),labelStyle:this.params.regionLabelStyle,labelsGroup:this.regionLabelsGroup,label:this.params.labels&&this.params.labels.regions}),this.regions[t]={config:this.mapData.paths[t],element:e}},createMarkers:function(t,e){var s,i;for(var a in this.markersGroup=this.markersGroup||this.canvas.createGroup(),this.markerLabelsGroup=this.markerLabelsGroup||this.canvas.createGroup(),t)!1!==(i=this.getMarkerPosition(t[a]))&&(s=new C({index:a,map:this,style:v(this.params.markerStyle,{initial:t[a].style||{}}),label:this.params.labels&&this.params.labels.markers,labelsGroup:this.markerLabelsGroup,cx:i.x,cy:i.y,group:this.markersGroup,isRecentlyCreated:!!e&&t[a]}),this.markers[a]&&this.removeMarkers([a]),this.markers[a]={element:s,config:t[a]})},createTooltip:function(){var t=this,e=this,s=c("div","jsvmap-toolip");this.tooltip=p(document.body.appendChild(s)),this.container.on("mousemove",(function(s){if("block"===e.tooltip.selector.style.display){var i=s.pageX-10-e.tooltip.width()+"px",a=s.pageY-10-e.tooltip.height()+"px";i<5&&(i=s.pageX+15),i<5&&(a=s.pageY+15),t.tooltip.css({left:i,top:a})}}))},createSeries:function(){var t,e;for(e in this.series={markers:[],regions:[]},this.params.series)for(t=0;t<this.params.series[e].length;t++)this.series[e][t]=new E(this.params.series[e][t],this[e],this)},handleElementEvents:function(){var t=this;this.container.delegate(".jsvmap-element","mouseover mouseout",(function(e){var s=T(t,this,!0),i=t.params.showTooltip;if("mouseover"===e.type){var a=e.defaultPrevented;a||s.element.hoverStatus(!0),i&&!a&&(t.tooltip.text(s.tooltipText),t.tooltip.show(),t.tooltipHeight=t.tooltip.height(),t.tooltipWidth=t.tooltip.width(),t.emit(s.event,[t.tooltip,s.code]))}else s.element.hoverStatus(!1),i&&t.tooltip.hide()})),this.container.delegate(".jsvmap-element","mouseup",(function(e){var s=T(t,this);if(("region"===s.type&&t.params.regionsSelectable||"marker"===s.type&&t.params.markersSelectable)&&!e.defaultPrevented){var i=s.element;t.params[s.type+"sSelectableOne"]&&t.clearSelected(s.type+"s"),s.element.isSelected?i.deselect():i.select(),t.emit(s.event,[s.code,s.element.isSelected,t.getSelected(s.type+"s")])}}))},setFocus:function(t){var e,s,i=this;if((t=t||{}).region&&m(t.region)?s=[t.region]:t.regions&&g(t.regions)&&(s=t.regions),s)return s.forEach((function(t){if(i.regions[t]){var s=i.regions[t].element.shape.getBBox();s&&(e=void 0===e?s:{x:Math.min(e.x,s.x),y:Math.min(e.y,s.y),width:Math.max(e.x+e.width,s.x+s.width)-Math.min(e.x,s.x),height:Math.max(e.y+e.height,s.y+s.height)-Math.min(e.y,s.y)})}})),this.setScale(Math.min(this.width/e.width,this.height/e.height),-(e.x+e.width/2),-(e.y+e.height/2),!0,t.animate)},bindContainerTouchEvents:function(){var t,e,s,i,a,r,n,o=this,h=function(h){var l,c,p,u,d=h.touches;if("touchstart"==h.type&&(n=0),1==d.length)1==n&&(p=o.transX,u=o.transY,o.transX-=(s-d[0].pageX)/o.scale,o.transY-=(i-d[0].pageY)/o.scale,o.tooltip.hide(),o.applyTransform(),p==o.transX&&u==o.transY||h.preventDefault()),s=d[0].pageX,i=d[0].pageY;else if(2==d.length)if(2==n)c=Math.sqrt(Math.pow(d[0].pageX-d[1].pageX,2)+Math.pow(d[0].pageY-d[1].pageY,2))/e,o.setScale(t*c,a,r),o.tooltip.hide(),h.preventDefault();else{var f=o.container.selector.getBoundingClientRect();l={top:f.top+window.scrollY,left:f.left+window.scrollX},a=d[0].pageX>d[1].pageX?d[1].pageX+(d[0].pageX-d[1].pageX)/2:d[0].pageX+(d[1].pageX-d[0].pageX)/2,r=d[0].pageY>d[1].pageY?d[1].pageY+(d[0].pageY-d[1].pageY)/2:d[0].pageY+(d[1].pageY-d[0].pageY)/2,a-=l.left,r-=l.top,t=o.scale,e=Math.sqrt(Math.pow(d[0].pageX-d[1].pageX,2)+Math.pow(d[0].pageY-d[1].pageY,2))}n=d.length};this.container.on("touchstart",h).on("touchmove",h)},applyTransform:function(){var t,e,s,i;this.defaultWidth*this.scale<=this.width?(t=(this.width-this.defaultWidth*this.scale)/(2*this.scale),s=(this.width-this.defaultWidth*this.scale)/(2*this.scale)):(t=0,s=(this.width-this.defaultWidth*this.scale)/this.scale),this.defaultHeight*this.scale<=this.height?(e=(this.height-this.defaultHeight*this.scale)/(2*this.scale),i=(this.height-this.defaultHeight*this.scale)/(2*this.scale)):(e=0,i=(this.height-this.defaultHeight*this.scale)/this.scale),this.transY>e?this.transY=e:this.transY<i&&(this.transY=i),this.transX>t?this.transX=t:this.transX<s&&(this.transX=s),this.canvas.applyTransformParams(this.scale,this.transX,this.transY),this.markers&&this.repositionMarkers(),this.repositionLabels()},resize:function(){var t=this.baseScale;this.width/this.height>this.defaultWidth/this.defaultHeight?(this.baseScale=this.height/this.defaultHeight,this.baseTransX=Math.abs(this.width-this.defaultWidth*this.baseScale)/(2*this.baseScale)):(this.baseScale=this.width/this.defaultWidth,this.baseTransY=Math.abs(this.height-this.defaultHeight*this.baseScale)/(2*this.baseScale)),this.scale*=this.baseScale/t,this.transX*=this.baseScale/t,this.transY*=this.baseScale/t},updateSize:function(){this.width=this.container.width(),this.height=this.container.height(),this.resize(),this.canvas.setSize(this.width,this.height),this.applyTransform()},coordsToPoint:function(t,e){var s,i,a,r=P.maps[this.params.map].projection,n=r.centralMeridian;return s=A[r.type](t,e,n),!!(i=this.getInsetForPoint(s.x,s.y))&&(a=i.bbox,s.x=(s.x-a[0].x)/(a[1].x-a[0].x)*i.width*this.scale,s.y=(s.y-a[0].y)/(a[1].y-a[0].y)*i.height*this.scale,{x:s.x+this.transX*this.scale+i.left*this.scale,y:s.y+this.transY*this.scale+i.top*this.scale})},setScale:function(t,e,s,i,a){var r,n,o,h,l,c,p,u,d,f,m=this,g=0,v=Math.abs(Math.round(60*(t-this.scale)/Math.max(t,this.scale)));t>this.params.zoomMax*this.baseScale?t=this.params.zoomMax*this.baseScale:t<this.params.zoomMin*this.baseScale&&(t=this.params.zoomMin*this.baseScale),void 0!==e&&void 0!==s&&(r=t/this.scale,i?(d=e+this.defaultWidth*(this.width/(this.defaultWidth*t))/2,f=s+this.defaultHeight*(this.height/(this.defaultHeight*t))/2):(d=this.transX-(r-1)/t*e,f=this.transY-(r-1)/t*s)),a&&v>0?(o=this.scale,h=(t-o)/v,l=this.transX*this.scale,p=this.transY*this.scale,c=(d*t-l)/v,u=(f*t-p)/v,n=setInterval((function(){g+=1,m.scale=o+h*g,m.transX=(l+c*g)/m.scale,m.transY=(p+u*g)/m.scale,m.applyTransform(),g==v&&(clearInterval(n),m.emit("viewport:changed",[m.scale,m.transX,m.transY]))}),10)):(this.transX=d,this.transY=f,this.scale=t,this.applyTransform(),this.emit("viewport:changed",[this.scale,this.transX,this.transY]))},getMarkerPosition:function(t){var e=t.coords;return P.maps[this.params.map].projection?this.coordsToPoint.apply(this,e):{x:e[0]*this.scale+this.transX*this.scale,y:e[1]*this.scale+this.transY*this.scale}},repositionMarkers:function(){var t;for(var e in this.markers)!1!==(t=this.getMarkerPosition(this.markers[e].config))&&this.markers[e].element.setStyle({cx:t.x,cy:t.y})},repositionLabels:function(){var t=this.params.labels;if(t){if(t.regions)for(var e in this.regions)this.regions[e].element.updateLabelPosition();if(t.markers)for(var s in this.markers)this.markers[s].element.updateLabelPosition()}}}),L={onViewportChange:"viewport:changed",onRegionSelected:"region:select",onMarkerSelected:"marker:select",onRegionTooltipShow:"region.tooltip:show",onMarkerTooltipShow:"marker.tooltip:show",onLoaded:"map:loaded"},P=function(){function t(e){if(void 0===e&&(e={}),this.params=v(t.defaults,e),!t.maps[this.params.map])throw new Error("Attempt to use map which was not loaded: "+e.map);this.mapData=t.maps[this.params.map],this.regionsData={},this.regionsColors={},this.markers={},this.defaultWidth=this.mapData.width,this.defaultHeight=this.mapData.height,this.height=0,this.width=0,this.scale=1,this.baseScale=1,this.transX=0,this.transY=0,this.baseTransX=0,this.baseTransY=0,this.regions={},"loading"!==window.document.readyState?initialize():window.addEventListener("DOMContentLoaded",initialize)}var e=t.prototype;return e.initialize=function(){this.container=p(options.selector).attr("class","jsvmap-container"),this.canvas=new x(this.container,this.width,this.height),this.setBackgroundColor(this.params.backgroundColor),this.handleContainerEvents(),this.createRegions(),this.updateSize(),this.createMarkers(this.params.markers||{}),this.params.showTooltip&&this.createTooltip(),this.params.zoomButtons&&this.handleZoomButtons(),this.params.selectedRegions&&this.setSelected("regions",this.params.selectedRegions),this.params.selectedMarkers&&this.setSelected("markers",this.params.selectedMarkers),this.params.focusOn&&this.setFocus(this.params.focusOn),this.params.bindTouchEvents&&("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)&&this.bindContainerTouchEvents(),this.handleElementEvents(),this.repositionLabels(),this.container.append(this.legendHorizontal=c("div","jsvmap-series-container jsvmap-series-h")).append(this.legendVertical=c("div","jsvmap-series-container jsvmap-series-v")),this.params.series&&this.createSeries(),this.emit("map:loaded",[this])},e.emit=function(t,e){for(var s in L)L[s]===t&&d(this.params[s])&&this.params[s].apply(this,e)},e.setBackgroundColor=function(t){this.container.css({backgroundColor:t})},e.getInsetForPoint=function(e,s){var i,a,r=t.maps[this.params.map].insets;for(i=0;i<r.length;i++)if(e>(a=r[i].bbox)[0].x&&e<a[1].x&&s>a[0].y&&s<a[1].y)return r[i]},e.getSelected=function(t){var e,s=[];for(e in this[t])this[t][e].element.isSelected&&s.push(e);return s},e.clearSelected=function(t){var e=this;this.getSelected(t).forEach((function(s){e[t][s].element.deselect()}))},e.setSelected=function(t,e){var s=this;e.forEach((function(e){s[t][e]&&s[t][e].element.select()}))},e.getSelectedRegions=function(){return this.getSelected("regions")},e.clearSelectedRegions=function(){var t=this;this.getSelected("regions").forEach((function(e){t.regions[e].element.deselect()}))},e.getSelectedMarkers=function(){return this.getSelected("markers")},e.clearSelectedMarkers=function(){var t=this;this.getSelected("markers").forEach((function(e){t.markers[e].element.deselect()}))},e.addMarker=function(t,e){var s;this.createMarkers(((s={})[t]=e,s),!0)},e.removeMarkers=function(t){var e=this;t.forEach((function(t){e.markers[t].element.remove(),delete e.markers[t]}))},e.reset=function(){for(var t in this.series)for(var e=0;e<this.series[t].length;e++)this.series[t][e].clear();this.height=0,this.width=0,this.scale=this.baseScale,this.transX=this.baseTransX,this.transY=this.baseTransY,this.applyTransform()},t}();P.maps={},P.defaults={map:"world",backgroundColor:"tranparent",draggable:!0,zoomButtons:!0,zoomOnScroll:!0,zoomOnScrollSpeed:3,zoomMax:12,zoomMin:1,zoomAnimate:!0,showTooltip:!0,zoomStep:1.5,bindTouchEvents:!0,markersSelectable:!1,markersSelectableOne:!1,markerStyle:{initial:{r:7,fill:"black",fillOpacity:1,stroke:"#FFF",strokeWidth:5,strokeOpacity:.65},hover:{fill:"#3cc0ff",stroke:"#5cc0ff",cursor:"pointer",strokeWidth:2},selected:{fill:"blue"},selectedHover:{}},markerLabelStyle:{initial:{fontFamily:"Verdana",fontSize:12,fontWeight:"bold",cursor:"default",fill:"black"},hover:{cursor:"pointer"}},regionsSelectable:!1,regionsSelectableOne:!1,regionStyle:{initial:{fill:"#e3eaef",fillOpacity:1,stroke:"none",strokeWidth:0,strokeOpacity:1},hover:{fillOpacity:.7,cursor:"pointer"},selected:{fill:"#000"},selectedHover:{}},regionLabelStyle:{initial:{fontFamily:"Verdana",fontSize:"12",fontWeight:"bold",cursor:"default",fill:"#35373e"},hover:{cursor:"pointer"}}},Object.assign(P.prototype,z);var D=function(){function t(t){if(void 0===t&&(t={}),!t.selector)throw new Error("Selector is not given.");return new P(t)}return t.prototype.addMap=function(t,e){P.maps[t]=e},t}();return window.jsVectorMap=window.JsVectorMap=D}));
